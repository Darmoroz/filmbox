{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,kIAyCA,SAASC,EAAiBC,GAExBC,EADmBD,EAAEE,O,CAIvB,SAASD,EAAoBE,GAG3B,IAAIC,EAFJD,EAAQE,UAAUC,IAAI,eACtBH,EAAQI,aAAa,YAAY,GAEjC,MAAMC,EAAc,IAAIL,EAAQM,cAAcC,UAAUC,MACtDC,GAAOA,IAAQT,IAEjBK,EAAYH,UAAUQ,OAAO,eAC7BL,EAAYM,gBAAgB,YAEE,YAA1BX,EAAQY,QAAQC,QAClBZ,GAAS,EAAAa,EAAAC,iBAAgBC,EAAAC,UAEG,UAA1BjB,EAAQY,QAAQC,QAClBZ,GAAS,EAAAa,EAAAC,iBAAgBC,EAAAE,QAE3BjB,EAAOkB,SAAQC,IACbA,EAAmB,UAAIA,EAAQC,OAAOC,KAAIC,GAASA,EAAMC,IAAG,IAE9D,MAAMC,GAAS,EAAAC,EAAAC,SAA8B1B,GAC7Ce,EAAAY,QAAQC,UAAY,GACpBb,EAAAY,QAAQE,mBAAmB,YAAaL,GACxCT,EAAAY,QAAQG,iBAAiB,QAASC,E,CAGpCC,eAAeD,EAA2BnC,GACxCqC,QAAQC,KAAKtC,EAAEE,OAAOqC,QAAQ,MAAMxB,QAAQY,UACtC,EAAAa,EAAAV,SAAoB9B,GAC1B,MAAMyC,EAAcC,SAASC,cAAc,gBAAgB5B,QAAQC,MACnE0B,SAASE,iBAAiB,gBAAgB,GAAGC,MAAMC,QAAU,OAC7D,MAAMC,EAAaL,SAASE,iBAAiB,gBAAgB,GAC7DG,EAAWjC,gBAAgB,YAEzBiC,EAAWf,UADO,YAAhBS,EACqB,sBAEA,oBAGEC,SAASM,eAAe,kBAChCC,oBACjB,QACA9B,EAAA+B,eAAeC,4BAEjBJ,EAAWb,iBAAiB,QAASkB,E,CAGvC,SAASA,EAAwBpD,GAC/B,MAAMqD,GAAWrD,EAAEE,OAAOa,QAAQsC,QAC5BZ,EAAcC,SAASC,cAAc,gBAE3C,IAAIW,EADJtD,EAAEE,OAAOK,aAAa,YAAY,GAElCgD,EAAAC,OAAOC,QAAQ,cACmB,YAA9BhB,EAAY1B,QAAQC,OACtBsC,GAAY,EAAArC,EAAAC,iBAAgBC,EAAAC,SAASsC,QAAOC,GAASA,EAAMhC,KAAO0B,KAClE,EAAApC,EAAA2C,iBAAgBzC,EAAAC,QAASkC,GACzBO,YAAW,MACT,EAAAC,EAAAhC,SAAOX,EAAA4C,QACP,EAAAC,EAAAlC,WACAX,EAAA8C,eAAejC,UAAY,EAAE,GAC5B,KACH/B,EAAoBwC,KAEpBa,GAAY,EAAArC,EAAAC,iBAAgBC,EAAAE,OAAOqC,QAAOC,GAASA,EAAMhC,KAAO0B,KAChE,EAAApC,EAAA2C,iBAAgBzC,EAAAE,MAAOiC,GACvBO,YAAW,MACT,EAAAC,EAAAhC,SAAOX,EAAA4C,QACP,EAAAC,EAAAlC,WACAX,EAAA8C,eAAejC,UAAY,EAAE,GAC5B,KACH/B,EAAoBwC,G,EA5FxB,EAAAyB,EAAAC,uBAEAC,OAAOlC,iBAAiB,oBAAoBE,UAC1C,IACEiC,OAAOC,OAAOnD,EAAAK,aAAc,EAAA+C,EAAAzC,YAE5B7B,EAAoBkB,EAAAqD,mBACpBrD,EAAAqD,kBAAkBtC,iBAAiB,QAASnC,GAC5CoB,EAAAsD,gBAAgBvC,iBAAiB,QAASnC,GAC1CqE,OAAOlC,iBAAiB,SAAUwC,EAAA7E,EAAA,CAAS8E,EAAA7C,QAAc,MACzDX,EAAAyD,eAAe1C,iBAAiB,QAASgC,EAAAW,YAIjC,CAHR,MAAOC,GAEP,OADAzC,QAAQC,IAAI,QAASwC,GACd,I,CACC","sources":["src/js/library.js"],"sourcesContent":["import throttle from 'lodash.throttle';\nimport {\n  QUEUE,\n  WATCHED,\n  gallery,\n  genres,\n  globalHandlers,\n  toggleThemeBtn,\n  watchedBtnLibrary,\n  queueBtnLibrary,\n  modal,\n  modalFullMovie,\n} from './refs';\nimport { setThemeFirstRender, toggleTheme } from './theme';\nimport handleScroll from './toTopBtn';\nimport { getLocalStorage, setLocalStorage } from './localStorage';\nimport createMarkupGalleryMoviesCard from './markup/createMarkupGalleryMoviesCard';\nimport renderMovieFullInfo from './render/renderMovieFullInfo';\nimport getAllGenres from './getAllGenres';\nimport toggle from './toggle';\nimport removeListener from './removeListener';\nimport { Notify } from 'notiflix';\n\nsetThemeFirstRender();\n\nwindow.addEventListener('DOMContentLoaded', async () => {\n  try {\n    Object.assign(genres, await getAllGenres());\n\n    renderLibraryMovies(watchedBtnLibrary);\n    watchedBtnLibrary.addEventListener('click', getLibraryMovies);\n    queueBtnLibrary.addEventListener('click', getLibraryMovies);\n    window.addEventListener('scroll', throttle(handleScroll, 500));\n    toggleThemeBtn.addEventListener('click', toggleTheme);\n  } catch (error) {\n    console.log('Error', error);\n    return null;\n  } finally {\n  }\n});\n\nfunction getLibraryMovies(e) {\n  const currentBtn = e.target;\n  renderLibraryMovies(currentBtn);\n}\n\nfunction renderLibraryMovies(btnType) {\n  btnType.classList.add('btn--active');\n  btnType.setAttribute('disabled', true);\n  let movies;\n  const neighborBtn = [...btnType.parentElement.children].find(\n    btn => btn !== btnType\n  );\n  neighborBtn.classList.remove('btn--active');\n  neighborBtn.removeAttribute('disabled');\n\n  if (btnType.dataset.value === 'watched') {\n    movies = getLocalStorage(WATCHED);\n  }\n  if (btnType.dataset.value === 'queue') {\n    movies = getLocalStorage(QUEUE);\n  }\n  movies.forEach(element => {\n    element['genre_ids'] = element.genres.map(ganre => ganre.id);\n  });\n  const markup = createMarkupGalleryMoviesCard(movies);\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('beforeend', markup);\n  gallery.addEventListener('click', renderMovieFullInfoLibrary);\n}\n\nasync function renderMovieFullInfoLibrary(e) {\n  console.log(+e.target.closest('li').dataset.id);\n  await renderMovieFullInfo(e);\n  const currentType = document.querySelector('.btn--active').dataset.value;\n  document.querySelectorAll('.btn--modify')[1].style.display = 'none';\n  const currentBtn = document.querySelectorAll('.btn--modify')[0];\n  currentBtn.removeAttribute('disabled');\n  if (currentType === 'watched') {\n    currentBtn.innerHTML = 'Remove from WATCHED';\n  } else {\n    currentBtn.innerHTML = 'Remove from QUEUE';\n  }\n\n  const btnCollectionBlock = document.getElementById('btn-collection');\n  btnCollectionBlock.removeEventListener(\n    'click',\n    globalHandlers.handleClickAddToCollection\n  );\n  currentBtn.addEventListener('click', removeMoviesFromLibrary);\n}\n\nfunction removeMoviesFromLibrary(e) {\n  const movieId = +e.target.dataset.movieId;\n  const currentType = document.querySelector('.btn--active');\n  e.target.setAttribute('disabled', true);\n  let newMovies;\n  Notify.success('Successful');\n  if (currentType.dataset.value === 'watched') {\n    newMovies = getLocalStorage(WATCHED).filter(movie => movie.id !== movieId);\n    setLocalStorage(WATCHED, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  } else {\n    newMovies = getLocalStorage(QUEUE).filter(movie => movie.id !== movieId);\n    setLocalStorage(QUEUE, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  }\n}\n"],"names":["$9OeKo","parcelRequire","$1cafa503bc57b7a0$var$getLibraryMovies","e","$1cafa503bc57b7a0$var$renderLibraryMovies","target","btnType","movies","classList","add","setAttribute","neighborBtn","parentElement","children","find","btn","remove","removeAttribute","dataset","value","$31u3U","getLocalStorage","$krGWQ","WATCHED","QUEUE","forEach","element","genres","map","ganre","id","markup","$aLPhN","default","gallery","innerHTML","insertAdjacentHTML","addEventListener","$1cafa503bc57b7a0$var$renderMovieFullInfoLibrary","async","console","log","closest","$boduE","currentType","document","querySelector","querySelectorAll","style","display","currentBtn","getElementById","removeEventListener","globalHandlers","handleClickAddToCollection","$1cafa503bc57b7a0$var$removeMoviesFromLibrary","movieId","newMovies","$7Y9D8","Notify","success","filter","movie","setLocalStorage","setTimeout","$6ZObK","modal","$20Q1x","modalFullMovie","$4S0r6","setThemeFirstRender","window","Object","assign","$aomY9","watchedBtnLibrary","queueBtnLibrary","$parcel$interopDefault","$hkaSy","toggleThemeBtn","toggleTheme","error"],"version":3,"file":"library.51e6b967.js.map"}