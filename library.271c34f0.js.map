{"mappings":"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","sources":["src/js/library.js"],"sourcesContent":["import throttle from 'lodash.throttle';\nimport {\n  QUEUE,\n  WATCHED,\n  gallery,\n  genres,\n  globalHandlers,\n  toggleThemeBtn,\n  watchedBtnLibrary,\n  queueBtnLibrary,\n  modal,\n  modalFullMovie,\n} from './refs';\nimport { setThemeFirstRender, toggleTheme } from './theme';\nimport handleScroll from './toTopBtn';\nimport { getLocalStorage, setLocalStorage } from './localStorage';\nimport createMarkupGalleryMoviesCard from './markup/createMarkupGalleryMoviesCard';\nimport renderMovieFullInfo from './render/renderMovieFullInfo';\nimport getAllGenres from './getAllGenres';\nimport toggle from './toggle';\nimport removeListener from './removeListener';\nimport { Notify } from 'notiflix';\n\nsetThemeFirstRender();\n\nwindow.addEventListener('DOMContentLoaded', async () => {\n  try {\n    Object.assign(genres, await getAllGenres());\n\n    renderLibraryMovies(watchedBtnLibrary);\n    watchedBtnLibrary.addEventListener('click', getLibraryMovies);\n    queueBtnLibrary.addEventListener('click', getLibraryMovies);\n    window.addEventListener('scroll', throttle(handleScroll, 500));\n    toggleThemeBtn.addEventListener('click', toggleTheme);\n  } catch (error) {\n    console.log('Error', error);\n    return null;\n  } finally {\n  }\n});\n\nfunction getLibraryMovies(e) {\n  const currentBtn = e.target;\n  renderLibraryMovies(currentBtn);\n}\n\nfunction renderLibraryMovies(btnType) {\n  btnType.classList.add('btn--active');\n  btnType.setAttribute('disabled', true);\n  let movies;\n  const neighborBtn = [...btnType.parentElement.children].find(\n    btn => btn !== btnType\n  );\n  neighborBtn.classList.remove('btn--active');\n  neighborBtn.removeAttribute('disabled');\n\n  if (btnType.dataset.value === 'watched') {\n    movies = getLocalStorage(WATCHED);\n  }\n  if (btnType.dataset.value === 'queue') {\n    movies = getLocalStorage(QUEUE);\n  }\n  movies.forEach(element => {\n    element['genre_ids'] = element.genres.map(ganre => ganre.id);\n  });\n  if (!movies.length) {\n    console.log('abra');\n    gallery.innerHTML = '<p class=\"empty\">empty list</p>';\n    console.dir(gallery);\n    return;\n  }\n  const markup = createMarkupGalleryMoviesCard(movies);\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('beforeend', markup);\n  gallery.addEventListener('click', renderMovieFullInfoLibrary);\n}\n\nasync function renderMovieFullInfoLibrary(e) {\n  await renderMovieFullInfo(e);\n  const currentType = document.querySelector('.btn--active').dataset.value;\n  document.querySelectorAll('.btn--modify')[1].style.display = 'none';\n  const currentBtn = document.querySelectorAll('.btn--modify')[0];\n  currentBtn.removeAttribute('disabled');\n  if (currentType === 'watched') {\n    currentBtn.innerHTML = 'Remove from WATCHED';\n  } else {\n    currentBtn.innerHTML = 'Remove from QUEUE';\n  }\n\n  const btnCollectionBlock = document.getElementById('btn-collection');\n  btnCollectionBlock.removeEventListener(\n    'click',\n    globalHandlers.handleClickAddToCollection\n  );\n  currentBtn.addEventListener('click', removeMoviesFromLibrary);\n}\n\nfunction removeMoviesFromLibrary(e) {\n  const movieId = +e.target.dataset.movieId;\n  const currentType = document.querySelector('.btn--active');\n  e.target.setAttribute('disabled', true);\n  let newMovies;\n  Notify.success('Successful');\n  if (currentType.dataset.value === 'watched') {\n    newMovies = getLocalStorage(WATCHED).filter(movie => movie.id !== movieId);\n    setLocalStorage(WATCHED, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  } else {\n    newMovies = getLocalStorage(QUEUE).filter(movie => movie.id !== movieId);\n    setLocalStorage(QUEUE, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  }\n}\n"],"names":["$bpxeT","parcelRequire","$93effc6fc56091ad$var$getLibraryMovies","e","$93effc6fc56091ad$var$renderLibraryMovies","target","btnType","movies","classList","add","setAttribute","neighborBtn","$parcel$interopDefault","$8nrFW","parentElement","children","find","btn","remove","removeAttribute","dataset","value","$UL92Z","getLocalStorage","$4Nugj","WATCHED","QUEUE","forEach","element","genres","map","ganre","id","length","console","log","gallery","innerHTML","dir","markup","$6mu73","default","insertAdjacentHTML","addEventListener","$93effc6fc56091ad$var$renderMovieFullInfoLibrary","$93effc6fc56091ad$var$_renderMovieFullInfoLibrary","apply","this","arguments","$2TvXO","mark","_callee","currentType","currentBtn","$kfpeU","document","querySelector","querySelectorAll","style","display","getElementById","removeEventListener","globalHandlers","handleClickAddToCollection","$93effc6fc56091ad$var$removeMoviesFromLibrary","newMovies","movieId","$6JpON","Notify","success","filter","movie","setLocalStorage","setTimeout","$k7GPO","modal","$UeXj6","modalFullMovie","$9VC5X","setThemeFirstRender","window","Object","$iw235","_ctx","t0","assign","call","t1","t2","watchedBtnLibrary","queueBtnLibrary","$dCfNN","$dEmTs","toggleThemeBtn","toggleTheme","t3"],"version":3,"file":"library.271c34f0.js.map"}