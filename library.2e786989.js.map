{"mappings":"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","sources":["src/js/library.js"],"sourcesContent":["import throttle from 'lodash.throttle';\nimport {\n  QUEUE,\n  WATCHED,\n  gallery,\n  genres,\n  globalHandlers,\n  toggleThemeBtn,\n  watchedBtnLibrary,\n  queueBtnLibrary,\n  modal,\n  modalFullMovie,\n} from './refs';\nimport { setThemeFirstRender, toggleTheme } from './theme';\nimport handleScroll from './toTopBtn';\nimport { getLocalStorage, setLocalStorage } from './localStorage';\nimport createMarkupGalleryMoviesCard from './markup/createMarkupGalleryMoviesCard';\nimport renderMovieFullInfo from './render/renderMovieFullInfo';\nimport getAllGenres from './getAllGenres';\nimport toggle from './toggle';\nimport removeListener from './removeListener';\nimport { Notify } from 'notiflix';\n\nsetThemeFirstRender();\n\nwindow.addEventListener('DOMContentLoaded', async () => {\n  try {\n    Object.assign(genres, await getAllGenres());\n\n    renderLibraryMovies(watchedBtnLibrary);\n    watchedBtnLibrary.addEventListener('click', getLibraryMovies);\n    queueBtnLibrary.addEventListener('click', getLibraryMovies);\n    window.addEventListener('scroll', throttle(handleScroll, 500));\n    toggleThemeBtn.addEventListener('click', toggleTheme);\n  } catch (error) {\n    console.log('Error', error);\n    return null;\n  } finally {\n  }\n});\n\nfunction getLibraryMovies(e) {\n  const currentBtn = e.target;\n  renderLibraryMovies(currentBtn);\n}\n\nfunction renderLibraryMovies(btnType) {\n  btnType.classList.add('btn--active');\n  btnType.setAttribute('disabled', true);\n  let movies;\n  const neighborBtn = [...btnType.parentElement.children].find(\n    btn => btn !== btnType\n  );\n  neighborBtn.classList.remove('btn--active');\n  neighborBtn.removeAttribute('disabled');\n\n  if (btnType.dataset.value === 'watched') {\n    movies = getLocalStorage(WATCHED);\n  }\n  if (btnType.dataset.value === 'queue') {\n    movies = getLocalStorage(QUEUE);\n  }\n  movies.forEach(element => {\n    element['genre_ids'] = element.genres.map(ganre => ganre.id);\n  });\n  const markup = createMarkupGalleryMoviesCard(movies);\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('beforeend', markup);\n  gallery.addEventListener('click', renderMovieFullInfoLibrary);\n}\n\nasync function renderMovieFullInfoLibrary(e) {\n  console.log(+e.target.closest('li').dataset.id);\n  await renderMovieFullInfo(e);\n  const currentType = document.querySelector('.btn--active').dataset.value;\n  document.querySelectorAll('.btn--modify')[1].style.display = 'none';\n  const currentBtn = document.querySelectorAll('.btn--modify')[0];\n  currentBtn.removeAttribute('disabled');\n  if (currentType === 'watched') {\n    currentBtn.innerHTML = 'Remove from WATCHED';\n  } else {\n    currentBtn.innerHTML = 'Remove from QUEUE';\n  }\n\n  const btnCollectionBlock = document.getElementById('btn-collection');\n  btnCollectionBlock.removeEventListener(\n    'click',\n    globalHandlers.handleClickAddToCollection\n  );\n  currentBtn.addEventListener('click', removeMoviesFromLibrary);\n}\n\nfunction removeMoviesFromLibrary(e) {\n  const movieId = +e.target.dataset.movieId;\n  const currentType = document.querySelector('.btn--active');\n  e.target.setAttribute('disabled', true);\n  let newMovies;\n  Notify.success('Successful');\n  if (currentType.dataset.value === 'watched') {\n    newMovies = getLocalStorage(WATCHED).filter(movie => movie.id !== movieId);\n    setLocalStorage(WATCHED, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  } else {\n    newMovies = getLocalStorage(QUEUE).filter(movie => movie.id !== movieId);\n    setLocalStorage(QUEUE, newMovies);\n    setTimeout(() => {\n      toggle(modal);\n      removeListener();\n      modalFullMovie.innerHTML = '';\n    }, 1000);\n    renderLibraryMovies(currentType);\n  }\n}\n"],"names":["$bpxeT","parcelRequire","$93effc6fc56091ad$var$getLibraryMovies","e","$93effc6fc56091ad$var$renderLibraryMovies","target","btnType","movies","classList","add","setAttribute","neighborBtn","$parcel$interopDefault","$8nrFW","parentElement","children","find","btn","remove","removeAttribute","dataset","value","$UL92Z","getLocalStorage","$4Nugj","WATCHED","QUEUE","forEach","element","genres","map","ganre","id","markup","$6mu73","default","gallery","innerHTML","insertAdjacentHTML","addEventListener","$93effc6fc56091ad$var$renderMovieFullInfoLibrary","$93effc6fc56091ad$var$_renderMovieFullInfoLibrary","apply","this","arguments","$2TvXO","mark","_callee","currentType","currentBtn","console","log","closest","$kfpeU","document","querySelector","querySelectorAll","style","display","getElementById","removeEventListener","globalHandlers","handleClickAddToCollection","$93effc6fc56091ad$var$removeMoviesFromLibrary","newMovies","movieId","$6JpON","Notify","success","filter","movie","setLocalStorage","setTimeout","$k7GPO","modal","$UeXj6","modalFullMovie","$9VC5X","setThemeFirstRender","window","Object","$iw235","_ctx","t0","assign","call","t1","t2","watchedBtnLibrary","queueBtnLibrary","$dCfNN","$dEmTs","toggleThemeBtn","toggleTheme","t3"],"version":3,"file":"library.2e786989.js.map"}